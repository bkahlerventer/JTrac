<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!-- Acegi security configuration as Spring context -->

<beans>
    
    <!-- change this to "import-acegi.xml" or "import-acegi-cas.xml" as required -->
    <import resource="import-acegi.xml"/> 
    
    <!-- Automatically receives AuthenticationEvent messages -->
    <bean id="loggerListener" class="org.acegisecurity.event.authentication.LoggerListener"/>    
    
    <!-- has to be first in the filter chain, this injects the security / session context for all the rest -->
    <bean id="httpSessionFilter" class="org.acegisecurity.context.HttpSessionContextIntegrationFilter"/>      
    
    <bean id="anonFilter" class="org.acegisecurity.providers.anonymous.AnonymousProcessingFilter">
        <property name="key" value="jtrac-anon"/>
        <property name="userAttribute" value="anonymousUser,ROLE_ANONYMOUS"/>
    </bean> 
    
    <bean name="authorizationFilter" class="org.acegisecurity.intercept.web.FilterSecurityInterceptor">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="accessDecisionManager">
            <bean class="org.acegisecurity.vote.AffirmativeBased">
                <property name="allowIfAllAbstainDecisions" value="false"/>
                <property name="decisionVoters">
                    <list>
                        <bean class="org.acegisecurity.vote.RoleVoter"/>
                    </list>
                </property>
            </bean>		      
        </property>     
        <property name="objectDefinitionSource">
            <value>
                PATTERN_TYPE_APACHE_ANT
                /index.jsp=ROLE_ANONYMOUS,ROLE_USER
                /error_cas.htm=ROLE_ANONYMOUS,ROLE_USER
                /test/**=ROLE_ANONYMOUS,ROLE_USER
                /resources/**=ROLE_ANONYMOUS,ROLE_USER
                /calendar/**=ROLE_ANONYMOUS,ROLE_USER
                /chart/*=ROLE_ANONYMOUS,ROLE_USER
                /svn_*=ROLE_ANONYMOUS,ROLE_USER                 
                /login.htm*=ROLE_ANONYMOUS,ROLE_USER
                /logout.htm=ROLE_ANONYMOUS,ROLE_USER
                /**=ROLE_USER
            </value>
        </property>
    </bean>  
           
</beans>


